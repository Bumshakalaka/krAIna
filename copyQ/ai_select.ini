[Command]
Command="
    copyq:
    // Set KrAIna installation folder in your home folder
    var kraina_dir = '/repos_personal/krAIna/';
    var kraina_script = 'kraina.sh';
    var list_skills = 'list_skills.sh';
    copy();
    var to_process = str(clipboard());
    if (!to_process) {
      if (dataFormats().indexOf('image/png') >= 0) {
          image = data('image/png');
          if (image.size() == 0) {
               popup('Abort', 'No image area specified', 1000);
               abort();
          }
          var f = new TemporaryFile();
          f.open();
          f.write(image);
          f.close();
          to_process = f.fileName();
      } else {
        popup('Abort', 'Nothing in clipboard usefull', 1000);
        abort();
      }
    }
    const snippets = execute(Dir().homePath() + kraina_dir + list_skills);
    var items = str(snippets.stdout).split(',');

    var selected_index = dialog('.title', 'Select Snippets', '.list:Select', items);
    if (selected_index == undefined) {
      abort();
    }
    const result = execute(Dir().homePath() + kraina_dir + kraina_script, items[Number(selected_index)], to_process);
    if (result.exit_code != 0) {
        popup('Error', str(result.stderr).trim(), 3000);
        abort();
    } else {
        copy(str(result.stdout).trim());
    }
    if (focused()) {
        hide();
    }
    paste();"
GlobalShortcut=alt+shift+1
Icon=\xf15b
InMenu=true
IsGlobalShortcut=true
Name=ai:select
Shortcut=alt+return